### Especificação de Caso de Uso: Calcular Pontos Auto. (Abstrato)

**Identificador:** UC-09

**Tipo:** Caso de Uso de Inclusão (Internal/Abstract) **Requisitos Relacionados:** RF-006 (Cálculo Automático)
**Objetivo:** Aplicar a regra matemática de conversão financeira para estimar a quantidade de milhas geradas por uma transação em reais.

#### 1. Pré-condições

- O valor da compra em reais (R$) deve ter sido informado e validado.
- Uma regra de conversão (fator multiplicador) deve existir no sistema.

#### 2. Condição de Entrada (Gatilho)

- Acionado exclusivamente pelo passo 6 do Fluxo Principal do **UC-02 (Registrar Transação)**.

#### 3. Fluxo Principal (Processo de Cálculo)

1. **[Sistema]** recebe o `Valor da Compra (R$)`.
2. **[Sistema]** recupera a `Cotação do Dólar` atual (valor fixo configurado ou via API, conforme implementação).
3. **[Sistema]** recupera o `Fator de Conversão` do cartão (ex: 1 ponto por dólar).
4. **[Sistema]** executa o algoritmo matemático:
   - _Fórmula:_ `(Valor em Reais / Cotação Dólar) * Fator de Conversão`.

5. **[Sistema]** arredonda o resultado para um número inteiro ou duas casas decimais (conforme padrão definido).
6. **[Sistema]** retorna o valor calculado (ex: 500 pontos) para o caso de uso chamador.
7. **O caso de uso termina.**

#### 4. Fluxos de Exceção

##### **FE-01: Erro de Divisão ou Cotação Zerada**

- **Gatilho:** A cotação do dólar não foi configurada ou é igual a zero.

1. **[Sistema]** detecta risco de divisão por zero.
2. **[Sistema]** assume uma cotação padrão de segurança (ou retorna 0 pontos).
3. **[Sistema]** registra o aviso em log interno (conforme RNF-005).
4. **[Retorno]:** O fluxo segue retornando 0 pontos para não travar o registro da compra.
