@inherits LayoutComponentBase
@using MudBlazor

<MudThemeProvider @bind-IsDarkMode="@_isDarkMode" Theme="_theme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="0" Class="app-bar-custom">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start"
            OnClick="@ToggleDrawer" />
        <MudIcon Icon="@Icons.Material.Filled.FlightTakeoff" Size="Size.Large" Class="mr-2" />
        <MudText Typo="Typo.h5" Class="brand-title">
            Miles Manager
        </MudText>
        <MudSpacer />
        <MudTooltip Text="Alternar tema">
            <MudIconButton Icon="@DarkLightModeButtonIcon" Color="Color.Inherit" OnClick="@ToggleTheme"
                Class="theme-toggle-btn" />
        </MudTooltip>
    </MudAppBar>

    <MudDrawer @bind-Open="_drawerOpen" Elevation="0" ClipMode="DrawerClipMode.Always" Class="custom-drawer">
        <NavMenu />
    </MudDrawer>

    <MudMainContent Class="main-content-custom">
        <MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="py-6">
            <MainErrorBoundary>
                @Body
            </MainErrorBoundary>
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private bool _drawerOpen = true;
    private bool _isDarkMode = false;
    private MudTheme _theme = new MudTheme()
    {
        PaletteLight = new PaletteLight()
        {
            Primary = "#6366F1",
            Secondary = "#EC4899",
            Tertiary = "#8B5CF6",
            Success = "#10B981",
            Info = "#3B82F6",
            Warning = "#F59E0B",
            Error = "#EF4444",
            Dark = "#1F2937",
            AppbarBackground = "#FFFFFF",
            AppbarText = "#1F2937",
            Background = "#F9FAFB",
            Surface = "#FFFFFF",
            DrawerBackground = "#FFFFFF",
            DrawerText = "#374151",
            TextPrimary = "#111827",
            TextSecondary = "#6B7280",
        },
        PaletteDark = new PaletteDark()
        {
            Primary = "#818CF8",
            Secondary = "#F472B6",
            Tertiary = "#A78BFA",
            Success = "#34D399",
            Info = "#60A5FA",
            Warning = "#FBBF24",
            Error = "#F87171",
            Dark = "#F9FAFB",
            AppbarBackground = "#111827",
            AppbarText = "#F9FAFB",
            Background = "#0F172A",
            Surface = "#1E293B",
            DrawerBackground = "#1E293B",
            DrawerText = "#E5E7EB",
            TextPrimary = "#F9FAFB",
            TextSecondary = "#9CA3AF",
        },
        LayoutProperties = new LayoutProperties()
        {
            DrawerWidthLeft = "260px",
            AppbarHeight = "64px"
        }
    };

    private string DarkLightModeButtonIcon => _isDarkMode
    ? Icons.Material.Rounded.LightMode
    : Icons.Material.Outlined.DarkMode;

    private void ToggleDrawer()
    {
        _drawerOpen = !_drawerOpen;
    }

    private void ToggleTheme()
    {
        _isDarkMode = !_isDarkMode;
    }
}